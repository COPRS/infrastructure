apiVersion: v1 
kind: Secret 
metadata: 
  name: postgres-backup-config
  labels:
    app.kubernetes.io/instance: postgres-operator
    app.kubernetes.io/managed-by: additional_resources
stringData: 
  BACKUP_SCHEDULE: "0 04 * * *" # Schedule a base backup every day at 4 am
  USE_WALG_BACKUP: "true" # Use the golang backup tool (faster)
  USE_WALG_RESTORE: "true" 
  BACKUP_NUM_TO_RETAIN: "30" # one month
  AWS_ACCESS_KEY_ID: <s3 access key>
  AWS_SECRET_ACCESS_KEY: <s3 secret key>
  AWS_ENDPOINT: <s3 endpoint url>
  AWS_REGION: <s3 region>
  WALG_DISABLE_S3_SSE: "false"
  WAL_S3_BUCKET: <s3 bucket>

  ## In case of point in time recovery/restore
  # CLONE_METHOD: CLONE_WITH_WALE
  # CLONE_AWS_ACCESS_KEY_ID: <s3 access key>
  # CLONE_AWS_SECRET_ACCESS_KEY: <s3 secret key>
  # CLONE_AWS_ENDPOINT: <s3 endpoint url>
  # CLONE_AWS_REGION: <s3 region>
  # CLONE_WAL_S3_BUCKET: <s3 bucket>
  # CLONE_WAL_BUCKET_SCOPE_SUFFIX: "/<id of the original cluster>"
  # CLONE_TARGET_TIME: "2020-02-04T12:49:03+00:00" # time in the WAL archive that we want to restore
  # CLONE_SCOPE: infra-postgres
