
[all]
{% for host in hosts %}
{{host}}    ansible_host={{ ip_adresses[loop.index0] }}    ansible_ssh_private_key_file={{ playbook_dir }}/../.ssh/{{ host }}.pem
{% endfor %}

[gateway]
{% for gateway in gateways %}
{{ gateway }}
{% endfor %}

[worker]
{% for node in nodes %}
{{ node }}
{% endfor %}

{% if add_egress %}
[egress]
{{ egresss[0] }}

{% endif %}
[kube_control_plane]
{% for master in masters %}
{{ master }}
{% endfor %}

[kube_node:children]
worker
gateway
{% if add_egress %}
egress
{% endif %}

[k8s_cluster:children]
kube_control_plane
kube_node

[worker:vars]
node_labels={"node-role.kubernetes.io/infra": ""}

[gateway:vars]
node_labels={"node-role.kubernetes.io/gateway":""}
node_taints={"node-role.kubernetes.io/gateway:NoSchedule"}

{% if add_egress %}
[egress:vars]
node_labels={"node-role.kubernetes.io/egress": ""}
{% endif %}
